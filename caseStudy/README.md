# Case study

This directory contains all data and code used for the case study on data from primary fibroblasts during human cytomeglovirus infection. 

Three different experimental scenarios were explored.
For all scenarios, the model and parameters used were from one of the best performing models in the database prediction experiment. 
This was done by copying the complete model's `.json` file into the `axRuns` directory and loading that models for all scenarios.

## Setup
The file `data.zip` contains feature files and reconstructed pathways created using [SPRAS](https://github.com/Reed-CompBio/spras) as described in the paper. 
Datasets of top pathways from reconstruction were chosen using [PPA](https://github.com/gitter-lab/pathway-parameter-advising). 

First, set up the directory by unzipping bundled data and creating directories to store pre-trained models. 

```
unzip data.zip
mkdir -p axRuns
mkdir -p runs
```

Since this case study uses hyperparmeters selected and models chosen from the database prediction experiment, some files generated by running the database prediction experiment need to be copied over. 

```
cp ../databasePrediction/axRuns/GATCONV-allPathBank-compartmentsNodes.json axRuns/.
cp ../databasePrediction/runs/GATCONV-allPathBank-compartmentsNodes.p_checkpoint runs/120-GATCONV-topPathways-compartmentsNodes.p_checkpoint
```

The `.json` file in `axRuns` contains the best-performing hyperparameters for the GATCONV model from hyperparameter tuning in the database prediction experiment and is used to create the model for all scenarios.
The checkpoint pickle file in the `run` directory contains the fully trained model from the database prediction experiment and is used in scenario 1 below. 

## Scenarios

1. The best performing pre-trained model from the database prediction expedriment was taken with no further modifications and used it to predict localizations at the 120hpi timepoint.
  This scenario is referred to as `120` in code and other files.
  The pretrained model was retrieved from the database prediction experiment by copying the checkpoint file from the completed database prediction experiment.

2. We trained a model using a separate dataset that measured protein localization using a similar method on a different cell type and under a different biological condition, HeLa cells undergoing EGF stimulation. 
  This scenario is refered to as `egf120` in code and other files. 

3. We trained a model on the same HCMV infection experiment at the 24hpi timepoint.
  This scenario is refered to as `same` in code and other files.

More information on these scenarios can be found in the paper and supplement. 


